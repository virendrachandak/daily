`vim`配置--`vimrc`文件----## `vimrc`介绍`vimrc`文件包含了`vim`启动时的初始化和可选运行时配置设置。在基于`Unix`的系统上这个文件的名称是`.vimrc`，在`windows`系统上是`_vimrc`。可以通过`vimrc`文件来自定义`vim`配置。例如一个非常简单的例子：```set shiftwidth=4 softtabstop=4set incsearch ignorecase hlsearch" Press space to clear search highlighting and any message already displayed.nnoremap <silent> <Space> :silent noh<Bar>echo<CR>```> 解释：> `shiftwidth`为自动缩进选项（`autoindent`）每步的空格数，在`cindent`，`>>`和`<<`等选项和操作符上使用。如果`shiftwidth`为0，会使用`tabstop`的值。可以通过`:set shiftwidth`来查看当前的设置。> `tabstop`即文件中每个`tab`相当于多少个空格字符。设置`expandtab`可以让每次输入`tab`时自动转换为空格。> `softtabstop`表示在编辑操作时输入或者删除（按`backspace`键）一个制表符(`tab`)相当于几个空格。> `incsearch`表示在输入时就开始搜索，`ignorecase`表示忽略大小写，`hlsearch`表示高亮搜索结果。> `nnoremap`相当于`normal noremap`的组合，即在普通模式下的键映射。> `"`是`vimrc`中的注释符号。<b style="color:red;">要为特定文件，或者特定类型文件自定义vim的配置，可以使用[`modeline`](http://vim.wikia.com/wiki/Modeline_magic)或者`auto commands`，详情可以自己在vim中输入[`:help auto-setting`](http://vimdoc.sourceforge.net/cgi-bin/help?tag=auto-setting)或者[`:help filetype`](http://vimdoc.sourceforge.net/cgi-bin/help?tag=filetype)来了解。</b>## `vimrc`的位置```Unix		$HOME/.vimrc 或 $HOME/.vim/vimrcOS/2		$HOME/.vimrc, $HOME/vimfiles/vimrc或 $VIM/.vimrc (or _vimrc)MS-Windows	$HOME/_vimrc, $HOME/vimfiles/vimrc或 $VIM/_vimrcAmiga		s:.vimrc, home:.vimrc, home:vimfiles:vimrc或 $VIM/.vimrc```其中`$HOME`的值为当前系统用户的用户目录。在*nix系统下直接`cd`进入的就是`$HOME`目录。> 注意：vim启动应用设置的顺序也和上面表中列出文件的先后顺序一致。如果有`gvimrc`文件的话，在打开GUI版（图形界面版）的vim时，会先应用`vimrc`中配置的选项，然后应用`gvimrc`中配置的选项。也可以利用`has('gui_running')`来定制`gvim`，如下所示：```if has('gui_running')  set guioptions=T " 没有工具栏  colorscheme desert " 设置颜色主题endif```虽然这样做也许可以避免同时有`vimrc`和`gvimrc`文件造成的混乱，但是`gvimrc`优势更加明显。最大的区别在于有`gvimrc`文件的话，可以通过`:gui`命令来将启动的vim变为gvim。`gui_running`检查里所做的配置通过`:gui`命令不会被应用，因为vim启动时只会`source` `vimrc`的内容。> 不了解`source`没关系，接着往下看。##  打开`vimrc``vim`会设置`MYVIMRC`环境变量来指向`vimrc`文件。因此，启动vim或者gvim后可以通过命令`:e $MYVIMRC`来打开`vimrc`文件。同理，也可以通过`:e $MYGVIMRC`文件来编辑`gvimrc`文件。> 小技巧：vim支持和bash、zsh一样的自动补全，输入`$M`后直接按`tab`键可以自动补全。> 通过`:version`命令可以查看详细的`vim`信息，例如版本号，可执行文件路径等。**`source` `vimrc`文件**`source`（即`execute`执行）`vimrc`文件。这样就不用关闭再重新打开vim了。```:so $MYVIMRC```或者，在打开了`vimrc`文件的情况下，可以使用下面的命令：```:so %```> `%`也是vim的一个变量，用于表示当前buffer（即当前正在编辑的文件）。<b style="color: red;">注意：<b>记得规划好`vimrc`文件中的内容，这样就不用频繁`source`了。而且，在定义了`command`，`function`以及`autocommand`时，确保在`source`时删除或者重载了之前定义的版本，否则在`source`时会有错误（对于`command`和`function`）或者重复（`autocommand`）。下面是正确的定义方法示例：```" 使用 `bang(!)`（即感叹号）来重新定义已经定义过的`command`和`function`command! MyCommand echo "Hello!"function! Myfunc()  echo "Hello!"endfunction" 将所有的`autocommand`放入`autogroup`，并使用`au!`来清理`group`。augroup vimrc_autocmds  au!  autocmd BufRead * echo "File Read!"augroup END```> 怎么样，通过上面的例子，是不是发现`vim`其实就像一种编程语言，我们可以通过函数、命令、自动命令来扩展定制实现自己想要的功能。Cool?!## 错误恢复`vimrc`中的一些配置错误会让vim不能成功启动。一种可靠的解决方法就是重命名`vimrc`文件，然后重新编辑重命名后的文件，并且重新编辑`vimrc`文件。用linux命令表示大概是下面的流程：```cdmv .vimrc .vimrc_with_faultvi .vimrc_with_fault//编辑完，复制到新建的.vimrc文件然后删除.vimrc_with_fault文件```或者，也可以不用这么麻烦，而是使用下面的命令：```vim -N -u NONE -U NONE````-N`表示以`非兼容模式`启动（即开启了vim的额外特性，否则就像vi一样了）。`NONE`（必须是大写）会跳过初始化并且不读取任何`vimrc`文件（`-u`），而且不读取任何`gvimrc`文件（`-U`）。然后，就可以用vim来编辑修改vimrc文件，去掉有错的内容了。> 小技巧，如果想偷懒，在每次修改了`vimrc`文件后自动`source`，可以在`vimrc`文件中加入下面这行内容。```au BufLeav ~/vimrc :source ~/.vimrc```### 参考资料[vimrc](http://vim.wikia.com/wiki/Vimrc)[filetype](http://vim.wikia.com/wiki/Filetype.vim)
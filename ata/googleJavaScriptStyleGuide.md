Google JavaScript编程风格指南----# 内容表JavaScript语言规则：* `var`* `常量`* 分号* 嵌套函数* 块内函数声明* 异常* 自定义异常* 标准功能* 原始值的包装对象* 多级原型层级* 方法和属性定义* `delete`* 闭包* `eval()`* `with() {}`* `this`* `for-in`循环* 关联数组* 多行字符常量* 数组和对象常量* 修改内置对象的原型* IE的条件注释JavaScript样式规则* 命名* 自定义`toString()`方法* 延迟初始化* 显示域* 代码格式化* 括号* 字符串* 可见性（私有和保护域）* JavaScript类型* 注释* 使用`goog.provide`提供依赖* 编译* 建议和技巧# JavaScript语言规则## `var`总是使用`var`来声明。如果没有指定`var`，变量会被放到全局上下问，可能会和已有的值冲突。此外，如果没有声明`var`，也很难判断变量的作用域（例如，在Document或者Window中，和在局部域中一样容易）。因此，总是使用`var`声明。## 常量* 常量值使用`NAMES_LIKE_THIS`这样的命名* 使用`@const`来指定一个常量指针（一个变量或者属性）* 不要使用[`const关键字`](https://developer.mozilla.org/en/JavaScript/Reference/Statements/const)，因为IE不支持**常量值**如果一个值是常量而且不能修改的，应该使用`CONSTANT_VALUES_CASE.ALL_CAPS`（即全部大写的常量名）来额外隐含`@const`的意思（值不能被覆盖）。原始值（`number,string,boolean`）都是常量值。`Object`的不可变性更加客观，一个对象只有再没有展示出可观察的状态修改时才被认为是不可变的。编译器并没有强制这点。**常量指针（变量和属性）**一个变量或者属性的`@const`标注表示它是不可覆盖的。编译器在build时会强制。该行为和[`const关键字`](https://developer.mozilla.org/en/JavaScript/Reference/Statements/const)一致（我们没有使用，因为IE不支持）。一个方法的`@const`标注还意味着在它的子类里也不能被重载。构造器上的`@const`标注意味着类不能有子类（类似于Java中的`final`）。**示例**注意`@const`并不一定意味着`CONSTANT_VALUES_CASE`。然而，`CONSTANT_VALUES_CASE`肯定意味着`@const`。```/** * Request timeout in milliseconds. * @type {number} */goog.example.TIMEOUT_IN_MILLISECONDS = 60;```一分钟时间的秒数是不会变的。这是一个常量值，`ALL_CAPS`也意味着`@const`，因此常量不能被覆盖。开源编译器会允许符号被重载，因为常量不会被标记为`@const`。```/** * Map of URL to response string. * @const */MyClass.fetchedUrlCache_ = new goog.structs.Map();/** * Class that cannot be subclassed. * @const * @constructor */sloth.MyFinalClass = function() {};```在本例中，指针不能被重载，但是值不是常量，是可以修改的（因此采用`camelCase`驼峰命名，而不是全部大写`ALL_CAPS`）。## 分号## 嵌套函数## 块内函数声明## 异常## 自定义异常## 标准功能## 原始值的包装对象## 多级原型层级## 方法和属性定义## `delete`## 闭包## `eval()`## `with() {}`## `this`## `for-in`循环## 关联数组## 多行字符常量## 数组和对象常量## 修改内置对象的原型## IE的条件注释# JavaScript样式规则## 命名## 自定义`toString()`方法## 延迟初始化## 显示域## 代码格式化## 括号## 字符串## 可见性（私有和保护域）## JavaScript类型## 注释## 使用`goog.provide`提供依赖## 编译## 建议和技巧###  原文<http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml>###  参考资料Douglas Crockford's Javascript: The Good Parts## JavaScript的优点* `function`--函数JavaScript的函数从词法作用域上来说属于一等公民。JavaScript是第一个成为主流的`lambda`语言。JavaScript更像Lisp和Schema而不是Java。实际上它是披着C语言衣服的Lisp。* `loose typing`--松散类型强类型并没有减少测试工作，而且强类型检查发现的错误并不是我们关心的错误。另一方面，松散类型让人从复杂的类型分级中解放了出来。* `dynamic objects`--动态对象JavaScript支持原型继承。即一个对象可以直接从其他对象继承属性。* `expressive object literal notation`--极具表达力的对象常量表示可以通过简单地列举对象的组成来创建对象。这样的表示方式也是JSON的灵感。## JavaScript的缺点* 基于全局变量的编程模型JavaScript依赖全局变量来连接。所有编译单元的所有顶级变量都被放到了一个公用的命名空间`global object`下。`global`（全局）对象是邪恶的，但这是JavaScript的基础。幸运的是，JavaScript提供了一些工具来缓解这个问题。# 语法## 字符串* 字符串常量* 被转义的字符> JavaScript字符串是xss和csrf等常见前端攻击的重要内容。## ## 问题```/^[\u999-\u99a]$/.test('a')// true```**XSS中的反复确认和规范化**```SELECT/*foo*/username,password/*foo*/FROM/*foo*/users<img%09onerror=alert(1) src=a>%00<script>alert(1)</script><scr<script>ipt><iframe src=j&#x61;vasc&#x72ipt&#x3a;alert&#x28;1&#x29;>```
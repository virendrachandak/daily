快速了解P3P----IE支持一种cookie限制隐私功能，称为P3P。Web开发者常常掉到它的坑里，因为还没有其他浏览器实现P3P标准。之前有过一篇更加详细的关于[IEcookie控制](http://blogs.msdn.com/b/ieinternals/archive/2010/06/05/understanding-internet-explorer-cookie-controls.aspx)的文章，本文却相当于一个简介，只说“基本的，需要了解的内容”。### P3P让事情简单默认，IE会拒绝来自第三方上下文（`3rd party context`）的cookie。所谓的“第三方上下文”指的是内容所在的域和拉取内容的页面所在的域不同。可能的第三方上下文包括任何接受URL属性值的元素：`<script>`，`<img>`，`<link>`，`<frame>`，`<iframe>`，`<audio>`，`<vide>`等等。还包括那些设置了`withCredentials`标记，还尝试发送cookie的【跨域请求——[`Cross-domain`](http://stackoverflow.com/questions/12643960/internet-explorer-10-is-ignoring-xmlhttprequest-xhr-withcredentials-true) [`XmlHttpRequest`](http://stackoverflow.com/questions/12643960/internet-explorer-10-is-ignoring-xmlhttprequest-xhr-withcredentials-true)】。例如，考虑下面这样带有`subframe`的页面：![](http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-47-13-metablogapi/8551.image_5F00_thumb_5F00_6E98BE09.png)第一方上下文是`domain1.com`，第三方上下文是`domain2.com`。默认如果`iframe`里的HTML内容尝试设置cookie会失败。IE会认为`domain2.com`的cookie不存在。不幸的是，IE的F12开发者工具不会显示这样的警告。在较老版本的IE里，可以在IE的状态栏看到一个小眼睛图标，但是IE9移除掉了。现在，要看一个cookie是不是被拒绝，必须点击`View > Web Page Privacy Policy`。![](http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-47-13-metablogapi/7485.image_5F00_07285B5A.png)该命令会显示在页面加载时的cookie概要。例如，加载本文英文原文时的情况如下：![](http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-47-13-metablogapi/0576.image_5F00_thumb_5F00_1F4BC5B5.png)### 声明自己的策略要让IE接受来自服务器的第三方上下文的cookie（或者让IE重新向服务器发送之前存取第三方上下文时发送的设置cookie的请求），必须在隐私策略中声明cookie的用途。声明的形式是HTTP响应的P3P头部（或者，比较少见的情况，内容相同的`META`标签）。例如，英文原文博客发送如下P3P响应头：```P3P: CP="ALL IND DSP COR ADM CONo CUR CUSo IVAo IVDo PSA PSD TAI TELo OUR SAMo CNT COM INT NAV ONL PHY PRE PUR UNI"```### 参考资料[英文原文](http://blogs.msdn.com/b/ieinternals/archive/2013/09/17/simple-introduction-to-p3p-cookie-blocking-frame.aspx)
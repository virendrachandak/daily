"a2d<C-V>3gE":vim普通模式语法
---

>   本文是纯粹从语言学上描述vim普通模式语法的学术练习。如果有冒险精神的话请继续阅读！

vim普通模式语言大量涉及“名词”和“动词”。然而，一直都没有合适的语言学描述。本文尝试对vim普通模式的语法进行语言学描述。

### 语法大纲

本语法大纲关注vim语法的句法。我们将检查标题中给出的最大语法句子`"a2d<C-V>3gE"`的所有成分。我们将先检查句法，包括对所有成分的综合检查，再讨论词序、词类，并在独立的章节中讨论一些形态学现象。

### 句法概述

#### 不及物句子（intransitive sentence）

vim中最小的句子只包含动词。

```
p   "粘贴默认寄存器中的内容"

$   "移动到行尾"
```

以上是vim中非及物句子的实例。只有几个非及物动词，例如`J`，`p`，`~`可以这样使用。和非及物句子中动词功能相同还有**动作动词（motion verbs）**，例如`w`，`^`，`gE`等。动作动词有一些与其他非及物动词不同的属性。在下面的章节中将看到更多动作动词。

因为vim的普通模式句子为命令，我们将它们视为指令（imperatives）：“put!”，“move!”。不需要加主语。

#### 及物句子（transitive verbs）

有些动词接受对象参数来组成基本的及物句子。

```
yaw     "复制整个词"
```

**及物动词（transitive verbs），或者称为操作符（operators）**包括`y`，`d`，`u`。**对象（object）**有两种：普通名词（文本对象，text object），例如`aw`（一个完整的词）和`i(`（括号内的内容）；以及参数函数（argument function）中的动作动词。

下面是参数函数中的一个动作动词：

```
dw      "删除到下一个词的开始处"
```

作为参数使用时，动作动词标注出了执行动作时将覆盖的范围。因此，`w`作为动词的意思为“将鼠标移动到下一个词的开始处”，但是`w`作为对象意思为“从当前鼠标位置到下一个词开头处之间的内容”。

在参数函数中使用动作动词时，动作动词的特殊属性[动作类型，motion type](http://vimdoc.sourceforge.net/htmldoc/motion.html#linewise)会变得很明显。有的动作动词会产生一个线性对象，而有的动作动词会产生一个字符级对象。

#### 数量词

动词和对象之前都可以加上一个**数量词（quantifier，或者称为count）**：

```
5gUe    "将从当前鼠标位置到下一个词结尾之间的内容变成大写字母，重复5次"
c2k     "修改从当前行开始（包含当前行）向上总共两行的内容"
```

可以同时又两个量词，例如我们标题中的句子：

```
2d3gE       "向后删除3个由空白分隔的词到词尾，重复两次"
```

动词和对象的量词关系密切。动词和对象量词相乘的乘积标出了整个谓词的数量。实际上，vim不会记录单个数量词，而是记录整个乘积。使用`.`命令加量词时，整个谓词的量词都会被新的量词代替。因此争论动词和对象的数量词代表了不连续的句法成分并非难以置信。

我们将目前提到的成分--动词（verb）、对象（object）以及可选的数量词（quantifier）--称为“核心谓词”。对于标题中的句子来说，核心谓词为`2d3gE`。

#### “目标Goal”

所有核心谓词都可以前置Goal（寄存器，参考资料[1](http://glts.github.io/2013/04/28/vim-normal-mode-grammar.html#fn:1)）。寄存器指定了谓词结果的存取位置。

```
`"adE`      "将从当前位置到下一个空白符分隔的词的词尾的内容删除并放入寄存器a"
`xp`        "剪切内容放入寄存器x中"
```

没有指定寄存器时，会使用默认的寄存器`"`。

值得一提的是默认的上下文信息不仅包含寄存器，还有记录位置和时间信息--即当前鼠标位置以及“现在”这些默认信息。因此，最简单的`p`句子意味着“在这个地方放置一次”，即`""1p`。“现在”为隐式信息，所有的句子都是实时的。

#### 副词

vim语法中较少人了解的是**副词（adverb)**（在源中称为“动作力量motion force”；vim的文档中[没有这个词的具体术语](http://vimdoc.sourceforge.net/htmldoc/motion.html#o_v)）。有三个副词`v`，`V`和`<C-V>`，分别指定了字符级、行级和块级操作。出现这三个副词时会改变动词应用到对象的方式。

考虑下面的句子：

```
`g?}`       "将从当前位置到段落末尾的字符级内容向前移动13个字符"
`g?V}`      "将从当前位置到段落末尾的行级内容向前移动13个字符"
```

上面两个句子都有相同的谓词，但是第二个句子使用了行级的`V`副词。动作动词`}`作为参数使用时为字符级动作类型，表示“从当前位置到段落末尾的内容”。

使用副词`V`将在适用范围内的内容加上行级限制，因此命令`g?V}`将把从鼠标所在位置到段落末尾所有行的内容前移13个字符。副词改变了核心谓词的意义。

An alternative analysis

### 参考资料

[1](http://glts.github.io/2013/04/28/vim-normal-mode-grammar.html#fn:1)

### 原文

[http://glts.github.io/2013/04/28/vim-normal-mode-grammar.html](http://glts.github.io/2013/04/28/vim-normal-mode-grammar.html)

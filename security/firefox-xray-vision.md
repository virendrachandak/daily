浏览器安全之Firefox Xray Vision----Xray vision让JavaScript运行在一个有安全权限控制的环境中，来安全地访问由低权限代码创建的对象，因为它只向调用者显示原生对象。Gecko会用不同权限执行不同来源的JavaScript：* JavaScript代码和实现浏览器的C++代码本身被称为`chome code`，它们执行时的权限是系统权限。[扩展](https://developer.mozilla.org/en-US/Add-ons)也拥有`chrome`权限。如果`chrome`权限的代码被攻破或者利用了，攻击者就可以控制用户的计算机。* 从普通页面加载的JavaScript被称为`content`代码，因为这样的代码是从任意页面加载的，因此被视为不安全而且对其他站点和用户有恶意的代码。* 除了上面两种权限，`chrome`代码还能创建[`sandboxes(沙箱)`](https://developer.mozilla.org/en-US/docs/Components.utils.Sandbox)，沙箱定义的[安全规则(`Security Principal`)](https://developer.mozilla.org/en-US/docs/Components.utils.Sandbox#Sandbox_principal)决定了它的权限。如果使用了扩展规则（`Expanded Principal`），沙箱会被授予`content`代码的权限，但是不能直接访问`content`代码。例如，Add-on SDK在啥箱内运行[内容脚本——`Content Scripts`](https://developer.mozilla.org/en-US/Add-ons/SDK/Guides/Content_Scripts)。Gecko的安全工具确保不同权限代码之间的访问是不对称的；例如，内容代码不能访问由chrome代码创建的对象，但是chrome代码可以访问由内容创建的对象。然而，即使能够访问内容对象也可能对chrome代码造成风险。JavaScript是一种高可塑性语言。页面上运行的脚本可以为DOM对象添加额外属性（也被称为[`expando`属性](https://developer.mozilla.org/en-US/docs/Glossary/Expando)），甚至重新定义标准的DOM对象来做一些意想不到的事情。如果chrome代码依赖于修改过的对象，可能会被诱使去做一些不应该做的事情。例如：`window.confirm()`被认为是一个向用户请求动作确认的DOM API，并且会依据用户点击“OK”还是“Cancel”来返回一个布尔值。网页可以重新将`window.config()`定义成返回`true`：```javascriptwindow.confirm = function() {  return true;}```### 参考资料<https://developer.mozilla.org/en-US/docs/Xray_vision#Xrays_for_JavaScript_objects>